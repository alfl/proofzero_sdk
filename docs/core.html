---

title: ProofZero Core SDK


keywords: fastai
sidebar: home_sidebar



nb_path: "core.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: core.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Benefits">Benefits<a class="anchor-link" href="#Benefits"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Generating matches across datasets is difficult. The same entities are described by different data (for example, one person using different phone numbers, or addresses). Data are often in different formats -- sometimes just a postal code is stored, sometimes a geo-region, sometimes a street address.</p>
<p>However all of these differences in physical data representation refer to the same logical entities.</p>
<p>The Proof Zero SDK generates pseudokeys that match entities across data sets containing different physical data representations. These pseudokeys enable a match between incomplete, incorrect, and unclean data sets. The percent strength of these pseudokey-based matches is also indicated.</p>
<p>The SDK also acts as a general-purpose feature hashing engine.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Workflow">Workflow<a class="anchor-link" href="#Workflow"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In order to join two datasets using pseudokeys we first <a href="/proofzero_sdk/core.html#load"><code>load</code></a> our data, and then:</p>
<ol>
<li><a href="/proofzero_sdk/core.html#tokenize"><code>tokenize</code></a> it -- decompose our data into standard formats,</li>
<li><a href="/proofzero_sdk/core.html#index"><code>index</code></a> it -- recompose our tokens into cryptographic indexes (privacy-aware feature hashes),</li>
<li><a href="/proofzero_sdk/core.html#match"><code>match</code></a> it -- compare indexed data sets to generate matches and measure match quality.</li>
</ol>
<p>This is the "TIM" workflow: <a href="/proofzero_sdk/core.html#tokenize"><code>tokenize</code></a>, <a href="/proofzero_sdk/core.html#index"><code>index</code></a>, <a href="/proofzero_sdk/core.html#match"><code>match</code></a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Security-and-data-privacy">Security and data privacy<a class="anchor-link" href="#Security-and-data-privacy"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>All SDK features run locally, so data remain within control of the user. match optionally allows use of Proof Zero's compute cluster and matching models to generate matches more quickly and with higher accuracy.</p>
<p>By using IndexFrame objects data remain in the control of the local system, even when using Proof Zero's compute cluster.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Exported-types">Exported types<a class="anchor-link" href="#Exported-types"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We provide several lightweight types that track progress through the TIM workflow:</p>
<ul>
<li><a href="/proofzero_sdk/core.html#TokenFrame"><code>TokenFrame</code></a> is a <code>pandas</code> DataFrame that has been tokenized.</li>
<li><a href="/proofzero_sdk/core.html#IndexFrame"><code>IndexFrame</code></a> is a <a href="/proofzero_sdk/core.html#TokenFrame"><code>TokenFrame</code></a> that has been hashed/indexed.</li>
<li><a href="/proofzero_sdk/core.html#MatchFrame"><code>MatchFrame</code></a> is a match between two <a href="/proofzero_sdk/core.html#IndexFrame"><code>IndexFrame</code></a>s.</li>
</ul>
<p>These types help systems and analysts keep track of where a given dataset is in the tokenize, index, match (TIM) workflow.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Loading-data">Loading data<a class="anchor-link" href="#Loading-data"> </a></h2><p>We load our data into standard <code>pandas</code> DataFrames.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load" class="doc_header"><code>load</code><a href="https://github.com/alfl/proofzero_sdk/tree/main/proofzero_sdk/core.py#L7" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load</code>(<strong><code>filename</code></strong>:<code>str</code>)</p>
</blockquote>
<p>Convenience function for loading files using <code>pandas</code>. Full version supports XLSX, etc.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_1</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s1">&#39;./data_1.csv&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">data_1</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;acct_num&#39;</span><span class="p">:</span> <span class="s1">&#39;PXCG66212484637575&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Kristin Sanchez MD&#39;</span><span class="p">,</span> <span class="s1">&#39;address&#39;</span><span class="p">:</span> <span class="s1">&#39;31417 Gina Lodge, Bradleytown, MB P7G 4N5&#39;</span><span class="p">,</span> <span class="s1">&#39;phone&#39;</span><span class="p">:</span> <span class="s1">&#39;1 (598) 742-6794&#39;</span><span class="p">,</span> <span class="s1">&#39;SIN&#39;</span><span class="p">:</span> <span class="s1">&#39;203 268 552&#39;</span><span class="p">,</span> <span class="s1">&#39;DOB&#39;</span><span class="p">:</span> <span class="s1">&#39;1943/04/15&#39;</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
<span class="n">data_1</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>acct_num</th>
      <th>name</th>
      <th>address</th>
      <th>phone</th>
      <th>SIN</th>
      <th>DOB</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PXCG66212484637575</td>
      <td>Kristin Sanchez MD</td>
      <td>31417 Gina Lodge, Bradleytown, MB P7G 4N5</td>
      <td>1 (598) 742-6794</td>
      <td>203 268 552</td>
      <td>1943/04/15</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tokenizing-data">Tokenizing data<a class="anchor-link" href="#Tokenizing-data"> </a></h2><p>We apply parsers to the DataFrames we want to process in order to decompose the physical data into standard types. This lets us re-compose a hashed index later that encodes knowledge of the underlying data structure.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="tokenize" class="doc_header"><code>tokenize</code><a href="https://github.com/alfl/proofzero_sdk/tree/main/proofzero_sdk/core.py#L21" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>tokenize</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>schema</code></strong>:<code>dict</code>, <strong><code>suffix_delim</code></strong>:<code>str</code>=<em><code>''</code></em>)</p>
</blockquote>
<p>Takes a <code>pandas</code> DataFrame and a schema. The schema is a <code>dict</code> that maps columns in the DataFrame to a list of parsers that are executed in order.</p>
<p>Denormalizes the passed DataFrame by applying the parsers in the schema.</p>
<p>Returns the denormalized DataFrame.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">proofzero_sdk.util</span> <span class="kn">import</span> <span class="n">parseString</span><span class="p">,</span> <span class="n">parseName</span><span class="p">,</span> <span class="n">parseAddress</span><span class="p">,</span> <span class="n">parsePhone</span><span class="p">,</span> <span class="n">parseSIN</span><span class="p">,</span> <span class="n">parseDate</span>
<span class="n">tokens_1</span> <span class="o">=</span> <span class="n">tokenize</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">data_1</span><span class="p">[:</span><span class="mi">1</span><span class="p">],</span> <span class="n">schema</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;acct_num&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">parseString</span><span class="p">],</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">parseName</span><span class="p">],</span>
    <span class="s1">&#39;address&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">parseAddress</span><span class="p">],</span>
    <span class="s1">&#39;phone&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">parsePhone</span><span class="p">],</span>
    <span class="s1">&#39;SIN&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">parseSIN</span><span class="p">],</span>
    <span class="s1">&#39;DOB&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">parseDate</span><span class="p">]</span>
<span class="p">},</span> <span class="n">suffix_delim</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
<span class="n">tokens_1</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>acct_num</th>
      <th>name</th>
      <th>address</th>
      <th>phone</th>
      <th>SIN</th>
      <th>DOB</th>
      <th>acct_num_0</th>
      <th>name_title</th>
      <th>name_first</th>
      <th>name_middle</th>
      <th>...</th>
      <th>phone_10</th>
      <th>phone_11</th>
      <th>SIN_0</th>
      <th>SIN_1</th>
      <th>SIN_2</th>
      <th>SIN_3</th>
      <th>DOB_0</th>
      <th>DOB_1</th>
      <th>DOB_2</th>
      <th>DOB_3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PXCG66212484637575</td>
      <td>Kristin Sanchez MD</td>
      <td>31417 Gina Lodge, Bradleytown, MB P7G 4N5</td>
      <td>1 (598) 742-6794</td>
      <td>203 268 552</td>
      <td>1943/04/15</td>
      <td>PXCG66212484637575</td>
      <td></td>
      <td>Kristin</td>
      <td></td>
      <td>...</td>
      <td>10</td>
      <td>None</td>
      <td>203-268-552</td>
      <td>203</td>
      <td>268</td>
      <td>552</td>
      <td>1943-04-15</td>
      <td>1943</td>
      <td>4</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 40 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Indexing-data">Indexing data<a class="anchor-link" href="#Indexing-data"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="index" class="doc_header"><code>index</code><a href="https://github.com/alfl/proofzero_sdk/tree/main/proofzero_sdk/core.py#L72" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>index</code>(<strong><code>df</code></strong>:<a href="/proofzero_sdk/core.html#TokenFrame"><code>TokenFrame</code></a>, <strong><code>schema</code></strong>:<code>dict</code>, <strong><code>hasher</code></strong>:<code>Callable</code>=<em><code>sha2</code></em>, <strong><code>suffix_delim</code></strong>:<code>str</code>=<em><code>''</code></em>)</p>
</blockquote>
<p>Tokenizes the passed DataFrame using <a href="/proofzero_sdk/core.html#tokenize"><code>tokenize</code></a>, then applies a hash function to the tokenized features.</p>
<p>The default hash function is <a href="/proofzero_sdk/util.html#sha2"><code>sha2</code></a>, from the Proof Zero utility SDK.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">index_1</span> <span class="o">=</span> <span class="n">index</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">tokens_1</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;acct_num&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">parseString</span><span class="p">],</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">parseName</span><span class="p">],</span>
    <span class="s1">&#39;address&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">parseAddress</span><span class="p">],</span>
    <span class="s1">&#39;phone&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">parsePhone</span><span class="p">],</span>
    <span class="s1">&#39;SIN&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">parseSIN</span><span class="p">],</span>
    <span class="s1">&#39;DOB&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">parseDate</span><span class="p">]</span>
<span class="p">},</span> <span class="n">suffix_delim</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
<span class="n">index_1</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>acct_num</th>
      <th>name</th>
      <th>address</th>
      <th>phone</th>
      <th>SIN</th>
      <th>DOB</th>
      <th>acct_num_0</th>
      <th>name_title</th>
      <th>name_first</th>
      <th>name_middle</th>
      <th>...</th>
      <th>phone_10</th>
      <th>phone_11</th>
      <th>SIN_0</th>
      <th>SIN_1</th>
      <th>SIN_2</th>
      <th>SIN_3</th>
      <th>DOB_0</th>
      <th>DOB_1</th>
      <th>DOB_2</th>
      <th>DOB_3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9802534054846731338401687891444750119150976961...</td>
      <td>4418369248196592421047499630841732388346555327...</td>
      <td>9594784023836219556184433361991357495783756657...</td>
      <td>7344459144365265142091263159766424283511268480...</td>
      <td>1010505653944236458406177846488691380962181960...</td>
      <td>5141391390246777661242717464678167327763772345...</td>
      <td>9802534054846731338401687891444750119150976961...</td>
      <td>3877226117079751550214273725156091025388555585...</td>
      <td>9229611837054111477081027882940374069625694253...</td>
      <td>3877226117079751550214273725156091025388555585...</td>
      <td>...</td>
      <td>9639508933775287426333904353415401342534309318...</td>
      <td>6586455234700639270600574409018427069812517107...</td>
      <td>1148673251264303964479456609021610855802601825...</td>
      <td>2948056107977080813370872483486457740221751010...</td>
      <td>5545403145286023377289154093249644763249517306...</td>
      <td>1018998564061470247772449997659560822438884579...</td>
      <td>7644637171458321163635300620903733517024394144...</td>
      <td>1020423811237369131177406386728771151256212182...</td>
      <td>6275815013823685249316828430045322558920567663...</td>
      <td>9930297093447128312648856684579760333304390435...</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 40 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Matching-data">Matching data<a class="anchor-link" href="#Matching-data"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="match" class="doc_header"><code>match</code><a href="https://github.com/alfl/proofzero_sdk/tree/main/proofzero_sdk/core.py#L88" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>match</code>(<strong><code>index_0</code></strong>:<a href="/proofzero_sdk/core.html#IndexFrame"><code>IndexFrame</code></a>, <strong><code>index_1</code></strong>:<a href="/proofzero_sdk/core.html#IndexFrame"><code>IndexFrame</code></a>, <strong><code>sensitivity</code></strong>=<em><code>0.5</code></em>, <strong><code>api_key</code></strong>:<code>str</code>=<em><code>None</code></em>)</p>
</blockquote>
<p>Discover matches between the two passed DataFrames. If <code>api_key</code> is set the indexed data can be matched using Proof Zero's cluster.</p>
<p><code>index_0</code> should contain exactly one row. If a whole-frame match is required pass this function to <code>pandas.DataFrame.apply</code>.</p>
<p><code>sensitivity</code> is the lowest <a href="https://en.wikipedia.org/wiki/Jaccard_index">Jaccard Index</a>, as a percentage, that indicates a match.</p>
<p>This function is compute-intense. Contact us for cloud scaling help.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_2</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s1">&#39;./data_2.csv&#39;</span><span class="p">)</span>
<span class="n">data_2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">2</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>acct_num</th>
      <th>name</th>
      <th>address</th>
      <th>phone</th>
      <th>SIN</th>
      <th>DOB</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>CUVC30129179791293</td>
      <td>Kristin Sanchez MD</td>
      <td>31417 Gina Lodge, Bradleytown, MB P7G 4N5</td>
      <td>742 598 6794</td>
      <td>203 268 552</td>
      <td>1943/04/15</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tokens_2</span> <span class="o">=</span> <span class="n">tokenize</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">data_2</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;acct_num&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">parseString</span><span class="p">],</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">parseName</span><span class="p">],</span>
    <span class="s1">&#39;address&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">parseAddress</span><span class="p">],</span>
    <span class="s1">&#39;phone&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">parsePhone</span><span class="p">],</span>
    <span class="s1">&#39;SIN&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">parseSIN</span><span class="p">],</span>
    <span class="s1">&#39;DOB&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">parseDate</span><span class="p">]</span>
<span class="p">},</span> <span class="n">suffix_delim</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">tokens_2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">2</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>acct_num</th>
      <th>name</th>
      <th>address</th>
      <th>phone</th>
      <th>SIN</th>
      <th>DOB</th>
      <th>DOB_0</th>
      <th>DOB_1</th>
      <th>DOB_2</th>
      <th>DOB_3</th>
      <th>...</th>
      <th>phone_10</th>
      <th>phone_11</th>
      <th>phone_2</th>
      <th>phone_3</th>
      <th>phone_4</th>
      <th>phone_5</th>
      <th>phone_6</th>
      <th>phone_7</th>
      <th>phone_8</th>
      <th>phone_9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>CUVC30129179791293</td>
      <td>Kristin Sanchez MD</td>
      <td>31417 Gina Lodge, Bradleytown, MB P7G 4N5</td>
      <td>742 598 6794</td>
      <td>203 268 552</td>
      <td>1943/04/15</td>
      <td>1943-04-15</td>
      <td>1943</td>
      <td>4</td>
      <td>15</td>
      <td>...</td>
      <td>20</td>
      <td>None</td>
      <td>742</td>
      <td>598</td>
      <td>6794</td>
      <td>7425986794</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>742 598 6794</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 43 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">index_2</span> <span class="o">=</span> <span class="n">index</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">tokens_2</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;acct_num&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">parseString</span><span class="p">],</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">parseName</span><span class="p">],</span>
    <span class="s1">&#39;address&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">parseAddress</span><span class="p">],</span>
    <span class="s1">&#39;phone&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">parsePhone</span><span class="p">],</span>
    <span class="s1">&#39;SIN&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">parseSIN</span><span class="p">],</span>
    <span class="s1">&#39;DOB&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">parseDate</span><span class="p">]</span>
<span class="p">},</span> <span class="n">suffix_delim</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
<span class="n">index_2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">2</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>acct_num</th>
      <th>name</th>
      <th>address</th>
      <th>phone</th>
      <th>SIN</th>
      <th>DOB</th>
      <th>DOB_0</th>
      <th>DOB_1</th>
      <th>DOB_2</th>
      <th>DOB_3</th>
      <th>...</th>
      <th>phone_10</th>
      <th>phone_11</th>
      <th>phone_2</th>
      <th>phone_3</th>
      <th>phone_4</th>
      <th>phone_5</th>
      <th>phone_6</th>
      <th>phone_7</th>
      <th>phone_8</th>
      <th>phone_9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>3118710362407207060820519817066124611602675044...</td>
      <td>4418369248196592421047499630841732388346555327...</td>
      <td>9594784023836219556184433361991357495783756657...</td>
      <td>5103122257192237244690193744677031637888782293...</td>
      <td>1010505653944236458406177846488691380962181960...</td>
      <td>5141391390246777661242717464678167327763772345...</td>
      <td>7644637171458321163635300620903733517024394144...</td>
      <td>1020423811237369131177406386728771151256212182...</td>
      <td>6275815013823685249316828430045322558920567663...</td>
      <td>9930297093447128312648856684579760333304390435...</td>
      <td>...</td>
      <td>1950749364813865911797004310287114589195880318...</td>
      <td>6586455234700639270600574409018427069812517107...</td>
      <td>1535860380141259287318590160938114468677934395...</td>
      <td>6055181033144981996992600968534808922389255124...</td>
      <td>5598189335674161013176229442725892028281044088...</td>
      <td>2209634314611670011518640833334290179954075682...</td>
      <td>6586455234700639270600574409018427069812517107...</td>
      <td>6586455234700639270600574409018427069812517107...</td>
      <td>6586455234700639270600574409018427069812517107...</td>
      <td>5103122257192237244690193744677031637888782293...</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 43 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">match_frame</span> <span class="o">=</span> <span class="n">match</span><span class="p">(</span><span class="n">index_1</span><span class="p">,</span> <span class="n">index_2</span><span class="p">)</span>
<span class="n">match_frame</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>acct_num</th>
      <th>name</th>
      <th>address</th>
      <th>phone</th>
      <th>SIN</th>
      <th>DOB</th>
      <th>DOB_0</th>
      <th>DOB_1</th>
      <th>DOB_2</th>
      <th>DOB_3</th>
      <th>...</th>
      <th>phone_0</th>
      <th>phone_10</th>
      <th>phone_2</th>
      <th>phone_3</th>
      <th>phone_4</th>
      <th>phone_5</th>
      <th>phone_6</th>
      <th>phone_7</th>
      <th>phone_9</th>
      <th>_match</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>3118710362407207060820519817066124611602675044...</td>
      <td>4418369248196592421047499630841732388346555327...</td>
      <td>9594784023836219556184433361991357495783756657...</td>
      <td>5103122257192237244690193744677031637888782293...</td>
      <td>1010505653944236458406177846488691380962181960...</td>
      <td>5141391390246777661242717464678167327763772345...</td>
      <td>7644637171458321163635300620903733517024394144...</td>
      <td>1020423811237369131177406386728771151256212182...</td>
      <td>6275815013823685249316828430045322558920567663...</td>
      <td>9930297093447128312648856684579760333304390435...</td>
      <td>...</td>
      <td>7341275782727882540070624817464065162426234694...</td>
      <td>1950749364813865911797004310287114589195880318...</td>
      <td>1535860380141259287318590160938114468677934395...</td>
      <td>6055181033144981996992600968534808922389255124...</td>
      <td>5598189335674161013176229442725892028281044088...</td>
      <td>2209634314611670011518640833334290179954075682...</td>
      <td>6586455234700639270600574409018427069812517107...</td>
      <td>6586455234700639270600574409018427069812517107...</td>
      <td>5103122257192237244690193744677031637888782293...</td>
      <td>0.692308</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 39 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

